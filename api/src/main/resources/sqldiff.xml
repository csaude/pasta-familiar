<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE sqldiff PUBLIC "-//OpenMRS//DTD OpenMRS SQL Diff Config 1.0//EN" "http://resources.openmrs.org/doctype/sqldiff-1.0.dtd">

<sqldiff version="1.0">
	<help>
		USE:
			The diffs are ordered by data model version number.
			The script can be run in a top down fashion and is
			expected to not fail or overwrite old data
		
		EXPECT:
			- "use business-database-name;" was called prior to
			   calling this script
	</help>

 
	<diff>
		<version>1.2</version>
		<author>Eurico Jose, Damasceno Lopes, Abdul Sacur - FGH</author>
		<date>Mar 01 2018</date>
		<description>Create Gaac tables for storing data of gaac module</description>
		<sql>
	
	
		CREATE TABLE IF NOT EXISTS `gaac_affinity_type` (
  		`gaac_affinity_type_id` int(11) NOT NULL AUTO_INCREMENT,
  		`name` varchar(50) NOT NULL DEFAULT '',
  		`description` text,
 		 `creator` int(11) NOT NULL DEFAULT '0',
  		`date_created` datetime NOT NULL DEFAULT '0000-00-00 00:00:00',
  		`retired` smallint(6) NOT NULL DEFAULT '0',
  		`retired_by` int(11) DEFAULT NULL,
  		`date_retired` datetime DEFAULT NULL,
  		`retire_reason` varchar(255) DEFAULT NULL,
  		`uuid` char(38) NOT NULL,
  		PRIMARY KEY (`gaac_affinity_type_id`),
  		UNIQUE KEY `gaac_affinity_type_uuid_index` (`uuid`),
 		KEY `user_who_created_type_gaac_affinity_type` (`creator`),
  		KEY `user_who_retired_gaac_affinity_type` (`retired_by`),
  		KEY `retired_status_gaac_affinity_type` (`retired`),
  		CONSTRAINT `user_who_created_type_gaac_affinity_type` FOREIGN KEY (`creator`) REFERENCES `users` (`user_id`),
  		CONSTRAINT `user_who_retired_gaac_affinity_type` FOREIGN KEY (`retired_by`) REFERENCES `users` (`user_id`)
		) ENGINE=InnoDB DEFAULT CHARSET=utf8;
		
		
		
		CREATE TABLE IF NOT EXISTS `gaac_reason_leaving_type` (
  		`gaac_reason_leaving_type_id` int(11) NOT NULL AUTO_INCREMENT,
  		`name` varchar(50) NOT NULL DEFAULT '',
  		`description` text,
  		`creator` int(11) NOT NULL DEFAULT '0',
  		`date_created` datetime NOT NULL DEFAULT '0000-00-00 00:00:00',
  		`retired` smallint(6) NOT NULL DEFAULT '0',
  		`retired_by` int(11) DEFAULT NULL,
  		`date_retired` datetime DEFAULT NULL,
  		`retire_reason` varchar(255) DEFAULT NULL,
  		`uuid` char(38) NOT NULL,
  		PRIMARY KEY (`gaac_reason_leaving_type_id`),
  		UNIQUE KEY `gaac_reason_leaving_type_uuid_index` (`uuid`),
  		KEY `user_who_created_gaac_reason_leaving_type` (`creator`),
  		KEY `user_who_retired_gaac_reason_leaving_type` (`retired_by`),
  		KEY `retired_status_gaac_reason_leaving_type` (`retired`),
  		CONSTRAINT `user_who_created_gaac_reason_leaving_type` FOREIGN KEY (`creator`) REFERENCES `users` (`user_id`),
  		CONSTRAINT `user_who_retired_gaac_reason_leaving_type` FOREIGN KEY (`retired_by`) REFERENCES `users` (`user_id`)
		) ENGINE=InnoDB DEFAULT CHARSET=utf8;
		
		
		
		CREATE TABLE IF NOT EXISTS `gaac` (
  		`gaac_id` int(11) NOT NULL AUTO_INCREMENT,
  		`name` varchar(50) NOT NULL DEFAULT '',
  		`description` text,
  		`gaac_identifier` varchar(50) DEFAULT NULL,
  		`start_date` date NOT NULL DEFAULT '0000-00-00',
  		`focal_patient_id` int(11) DEFAULT '0',
  		`affinity_type` int(11) DEFAULT '0',
  		`location_id` int(11) DEFAULT NULL,
  		`crumbled` smallint(2) DEFAULT '0',
  		`reason_crumbled` varchar(255) DEFAULT NULL,
  		`date_crumbled` date DEFAULT NULL,
  		`creator` int(11) NOT NULL DEFAULT '0',
  		`date_created` datetime NOT NULL DEFAULT '0000-00-00 00:00:00',
  		`changed_by` int(11) DEFAULT '0',
  		`date_changed` datetime DEFAULT '0000-00-00 00:00:00',
  		`voided` smallint(6) NOT NULL DEFAULT '0',
  		`voided_by` int(11) DEFAULT NULL,
  		`date_voided` datetime DEFAULT NULL,
  		`void_reason` varchar(255) DEFAULT NULL,
  		`uuid` char(38) NOT NULL,
  		PRIMARY KEY (`gaac_id`),
  		UNIQUE KEY `pk_gaac` (`gaac_id`),
  		KEY `fk_gaac_focal_patient` (`focal_patient_id`),
  		KEY `fk_gaac_user_who_created` (`creator`),
  		KEY `fk_gaac_user_who_voided` (`voided_by`),
  		KEY `fk_gaac_user_who_changed` (`changed_by`),
  		KEY `fk_gaac_affinity` (`affinity_type`),
  		KEY `fk_gaac_location` (`location_id`),
  		CONSTRAINT `fk_gaac_affinity` FOREIGN KEY (`affinity_type`) REFERENCES `gaac_affinity_type` (`gaac_affinity_type_id`),
  		CONSTRAINT `fk_gaac_focal_patient` FOREIGN KEY (`focal_patient_id`) REFERENCES `patient` (`patient_id`) ON DELETE SET NULL ON UPDATE CASCADE,
  		CONSTRAINT `fk_gaac_location` FOREIGN KEY (`location_id`) REFERENCES `location` (`location_id`),
  		CONSTRAINT `fk_gaac_user_who_changed` FOREIGN KEY (`changed_by`) REFERENCES `users` (`user_id`),
  		CONSTRAINT `fk_gaac_user_who_created` FOREIGN KEY (`creator`) REFERENCES `users` (`user_id`),
  		CONSTRAINT `fk_gaac_user_who_voided` FOREIGN KEY (`voided_by`) REFERENCES `users` (`user_id`)
		) ENGINE=InnoDB DEFAULT CHARSET=utf8;

		
	
		
		CREATE TABLE IF NOT EXISTS `gaac_member` (
  		`gaac_member_id` int(11) NOT NULL AUTO_INCREMENT,
  		`gaac_id` int(11) NOT NULL DEFAULT '0',
  		`member_id` int(11) NOT NULL DEFAULT '0',
  		`start_date` date NOT NULL DEFAULT '0000-00-00',
  		`end_date` date DEFAULT NULL,
  		`reason_leaving_type` int(11) DEFAULT NULL,
  		`description` text,
  		`leaving` smallint(1) DEFAULT '0',
  		`restart` smallint(1) DEFAULT '0',
 		`restart_date` date DEFAULT NULL,
  		`creator` int(11) NOT NULL DEFAULT '0',
  		`date_created` datetime NOT NULL DEFAULT '0000-00-00 00:00:00',
  		`changed_by` int(11) DEFAULT NULL,
  		`date_changed` datetime DEFAULT NULL,
  		`voided` smallint(6) NOT NULL DEFAULT '0',
  		`voided_by` int(11) DEFAULT NULL,
  		`date_voided` datetime DEFAULT NULL,
  		`void_reason` varchar(255) DEFAULT NULL,
  		`uuid` char(38) NOT NULL,
  		PRIMARY KEY (`gaac_member_id`),
  		KEY `fk_gaac_member_user_who_created` (`creator`),
  		KEY `fk_gaac_member_user_who_voided` (`voided_by`),
  		KEY `fk_gaac_member_user_who_changed` (`changed_by`),
  		KEY `fk_gaac_member_gaac` (`gaac_id`),
  		KEY `fk_gaac_member_patient` (`member_id`),
  		KEY `fk_gaac_member_reason_leaving` (`reason_leaving_type`),
  		CONSTRAINT `fk_gaac_member_gaac` FOREIGN KEY (`gaac_id`) REFERENCES `gaac` (`gaac_id`) ON DELETE CASCADE ON UPDATE CASCADE,
  		CONSTRAINT `fk_gaac_member_patient` FOREIGN KEY (`member_id`) REFERENCES `patient` (`patient_id`) ON DELETE CASCADE ON UPDATE CASCADE,
  		CONSTRAINT `fk_gaac_member_reason_leaving` FOREIGN KEY (`reason_leaving_type`) REFERENCES `gaac_reason_leaving_type` (`gaac_reason_leaving_type_id`),
  		CONSTRAINT `fk_gaac_member_user_who_changed` FOREIGN KEY (`changed_by`) REFERENCES `users` (`user_id`),
  		CONSTRAINT `fk_gaac_member_user_who_created` FOREIGN KEY (`creator`) REFERENCES `users` (`user_id`),
  		CONSTRAINT `fk_gaac_member_user_who_voided` FOREIGN KEY (`voided_by`) REFERENCES `users` (`user_id`)
		) ENGINE=InnoDB DEFAULT CHARSET=utf8;
	
	
		
	
		
		
		CREATE TABLE IF NOT EXISTS `gaac_family` (
  		`family_id` int(11) NOT NULL AUTO_INCREMENT,
  		`family_identifier` varchar(50) DEFAULT NULL,
  		`start_date` DATE NOT NULL DEFAULT '0000-00-00',
		`end_date` DATE NULL DEFAULT '0000-00-00',
  		`focal_patient_id` int(11) DEFAULT '0',
  		`location_id` int(11) DEFAULT NULL,
  		`crumbled` smallint(2) DEFAULT '0',
  		`reason_crumbled` varchar(255) DEFAULT NULL,
  		`date_crumbled` date DEFAULT NULL,
  		`creator` int(11) NOT NULL DEFAULT '0',
  		`date_created` datetime NOT NULL DEFAULT '0000-00-00 00:00:00',
  		`changed_by` int(11) DEFAULT '0',
  		`date_changed` datetime DEFAULT '0000-00-00 00:00:00',
  		`voided` smallint(6) NOT NULL DEFAULT '0',
  		`voided_by` int(11) DEFAULT NULL,
  		`date_voided` datetime DEFAULT NULL,
  		`void_reason` varchar(255) DEFAULT NULL,
  		`uuid` char(38) NOT NULL,
  		PRIMARY KEY (`family_id`),
  		UNIQUE KEY `pk_family` (`family_id`),
  		KEY `fk_family_focal_patient` (`focal_patient_id`),
  		KEY `fk_family_user_who_created` (`creator`),
  		KEY `fk_family_user_who_voided` (`voided_by`),
  		KEY `fk_family_user_who_changed` (`changed_by`),
  		KEY `fk_family_location` (`location_id`),
  		CONSTRAINT `fk_family_focal_patient` FOREIGN KEY (`focal_patient_id`) REFERENCES `patient` (`patient_id`) ON DELETE SET NULL ON UPDATE CASCADE,
  		CONSTRAINT `fk_family_location` FOREIGN KEY (`location_id`) REFERENCES `location` (`location_id`),
  		CONSTRAINT `fk_family_user_who_changed` FOREIGN KEY (`changed_by`) REFERENCES `users` (`user_id`),
  		CONSTRAINT `fk_family_user_who_created` FOREIGN KEY (`creator`) REFERENCES `users` (`user_id`),
  		CONSTRAINT `fk_family_user_who_voided` FOREIGN KEY (`voided_by`) REFERENCES `users` (`user_id`)
		) ENGINE=InnoDB DEFAULT CHARSET=utf8;

		
		
		CREATE TABLE IF NOT EXISTS `gaac_family_member` (
  		`family_member_id` int(11) NOT NULL AUTO_INCREMENT,
  		`family_id` int(11) NOT NULL DEFAULT '0',
  		`member_id` int(11) NOT NULL DEFAULT '0',
		`family_member_relacao` int(11) DEFAULT '0',
  		`start_date` date NOT NULL DEFAULT '0000-00-00',
  		`end_date` date DEFAULT NULL,
  		`reason_leaving_type` int(11) DEFAULT NULL,
  		`leaving` smallint(1) DEFAULT '0',
  		`restart` smallint(1) DEFAULT '0',
 		`restart_date` date DEFAULT NULL,
  		`creator` int(11) NOT NULL DEFAULT '0',
  		`date_created` datetime NOT NULL DEFAULT '0000-00-00 00:00:00',
  		`changed_by` int(11) DEFAULT NULL,
  		`date_changed` datetime DEFAULT NULL,
  		`voided` smallint(6) NOT NULL DEFAULT '0',
  		`voided_by` int(11) DEFAULT NULL,
  		`date_voided` datetime DEFAULT NULL,
  		`void_reason` varchar(255) DEFAULT NULL,
  		`uuid` char(38) NOT NULL,
  		PRIMARY KEY (`family_member_id`),
  		KEY `fk_family_member_user_who_created` (`creator`),
  		KEY `fk_family_member_user_who_voided` (`voided_by`),
  		KEY `fk_family_member_user_who_changed` (`changed_by`),
  		KEY `fk_family_member_family` (`family_id`),
  		KEY `fk_family_member_patient` (`member_id`),
		KEY `fk_family_member_relacao` (`family_member_relacao`),
  		KEY `fk_family_member_reason_leaving` (`reason_leaving_type`),
		CONSTRAINT `fk_family_member_relacao` FOREIGN KEY (`family_member_relacao`) REFERENCES `relationship` (`relationship_id`),
  		CONSTRAINT `fk_family_member_family` FOREIGN KEY (`family_id`) REFERENCES `gaac_family` (`family_id`) ON DELETE CASCADE ON UPDATE CASCADE,
  		CONSTRAINT `fk_family_member_patient` FOREIGN KEY (`member_id`) REFERENCES `patient` (`patient_id`) ON DELETE CASCADE ON UPDATE CASCADE,
  		CONSTRAINT `fk_family_member_reason_leaving` FOREIGN KEY (`reason_leaving_type`) REFERENCES `gaac_reason_leaving_type` (`gaac_reason_leaving_type_id`),
  		CONSTRAINT `fk_family_member_user_who_changed` FOREIGN KEY (`changed_by`) REFERENCES `users` (`user_id`),
  		CONSTRAINT `fk_family_member_user_who_created` FOREIGN KEY (`creator`) REFERENCES `users` (`user_id`),
  		CONSTRAINT `fk_family_member_user_who_voided` FOREIGN KEY (`voided_by`) REFERENCES `users` (`user_id`)
		) ENGINE=InnoDB DEFAULT CHARSET=utf8;
		
		
		INSERT IGNORE INTO gaac_affinity_type(gaac_affinity_type_id,name,description,creator,date_created,uuid) values(1,'Amizade','Grupo de amigos',1,now(),'c995afca-d8c1-4b7b-8b0c-37947993df6f');
		INSERT IGNORE INTO gaac_affinity_type(gaac_affinity_type_id,name,description,creator,date_created,uuid) values(2,'Familiar','Grupo de familias',1,now(),'d86ca8e9-1789-49cb-b7c1-dfdf7f21e1f7');
		INSERT IGNORE INTO gaac_affinity_type(gaac_affinity_type_id,name,description,creator,date_created,uuid) values(3,'Igreja','Grupo de irmãos que frequentam a mesma igreja',1,now(),'507b327a-c873-4e7b-a464-a37347507de7');	
		INSERT IGNORE INTO gaac_affinity_type(gaac_affinity_type_id,name,description,creator,date_created,uuid) values(4,'Mesquita','Grupo de irmãos muçulmanos que rezam na mesma mesquita',1,now(),'c7659bd5-27ec-4cd4-9f6e-1cb08e481c5f');
		INSERT IGNORE INTO gaac_affinity_type(gaac_affinity_type_id,name,description,creator,date_created,uuid) values(5,'Residencia','Grupo de vizinhos',1,now(),'a7a18ce7-b0f5-4a49-b251-0aaea5bf5206');
		INSERT IGNORE INTO gaac_affinity_type(gaac_affinity_type_id,name,description,creator,date_created,uuid) values(6,'Trabalho','Grupo de colegas de trabalho',1,now(),'f988c01d-274b-4a4b-b924-3bb3550b9f2a');
		INSERT IGNORE INTO gaac_affinity_type(gaac_affinity_type_id,name,description,creator,date_created,uuid) values(7,'Outro','Outro tipo de grupo',1,now(),'82008fea-de96-47a5-a6f5-a22257075923');
	
	
	
		INSERT IGNORE INTO gaac_reason_leaving_type(gaac_reason_leaving_type_id,name,description,creator,date_created,uuid) values(1,'Transferido Para','Transferido para outra US',1,now(),'abfc3f72-c55c-4eb6-9004-25a6735a70b9');
		INSERT IGNORE INTO gaac_reason_leaving_type(gaac_reason_leaving_type_id,name,description,creator,date_created,uuid) values(2,'Desistiu','Desistiram ou foram retirados do Gaac',1,now(),'d7df4950-c2ef-44f0-a8a6-8a328a21a19c');
		INSERT IGNORE INTO gaac_reason_leaving_type(gaac_reason_leaving_type_id,name,description,creator,date_created,uuid) values(3,'Obitou','Obitou em Gaac',1,now(),'52c37b18-ad27-42ed-851d-dcf1d81471da');
		INSERT IGNORE INTO gaac_reason_leaving_type(gaac_reason_leaving_type_id,name,description,creator,date_created,uuid) values(4,'Suspenso','Suspenso do Gaac',1,now(),'9dd52ebe-632d-49b2-8aa8-c3a5ca185ffe');
		INSERT IGNORE INTO gaac_reason_leaving_type(gaac_reason_leaving_type_id,name,description,creator,date_created,uuid) values(5,'Desintegracao','Desintegração do grupo',1,now(),'0ed9d571-36eb-453b-a1f1-785f367f92f1');
		
		INSERT IGNORE INTO `relationship_type` (`relationship_type_id`,`a_is_to_b`,`b_is_to_a`,`preferred`,`weight`,`description`,`creator`,`date_created`,`uuid`,`retired`,`retired_by`,`date_retired`,`retire_reason`) VALUES  (5,'Mãe','Filho/Filha',0,0,'Relacionamento entre mãe e filho',1,'2017-01-26 10:11:04','2b00dfef-a5dc-49e6-b406-762683938efa',0,NULL,NULL,NULL);
	INSERT IGNORE INTO `relationship_type` (`relationship_type_id`,`a_is_to_b`,`b_is_to_a`,`preferred`,`weight`,`description`,`creator`,`date_created`,`uuid`,`retired`,`retired_by`,`date_retired`,`retire_reason`) VALUES  (6,'Filha/Filho','Mae',0,0,'A para B',1,'2017-09-15 09:34:39','0fe8f7fa-f2bc-463e-b01f-ea5899621dff',0,NULL,NULL,NULL);
	INSERT IGNORE INTO `relationship_type` (`relationship_type_id`,`a_is_to_b`,`b_is_to_a`,`preferred`,`weight`,`description`,`creator`,`date_created`,`uuid`,`retired`,`retired_by`,`date_retired`,`retire_reason`) VALUES (7,'Irmão/Irmã','Irmão/Irmã',0,0,'A para B',1,'2017-09-21 14:23:03','333be161-e33d-4f79-bedd-1f6be7ce56f6',0,NULL,NULL,NULL);
 INSERT IGNORE INTO `relationship_type` (`relationship_type_id`,`a_is_to_b`,`b_is_to_a`,`preferred`,`weight`,`description`,`creator`,`date_created`,`uuid`,`retired`,`retired_by`,`date_retired`,`retire_reason`) VALUES (8,'Sobrinho/Sobrinha','Tio/Tia',0,0,'A para B',1,'2017-09-21 14:23:40','0a938a11-a5ce-422f-ad92-ddee18a35e4e',0,NULL,NULL,NULL);
INSERT IGNORE INTO `relationship_type` (`relationship_type_id`,`a_is_to_b`,`b_is_to_a`,`preferred`,`weight`,`description`,`creator`,`date_created`,`uuid`,`retired`,`retired_by`,`date_retired`,`retire_reason`) VALUES  (9,'Esposa/Esposo','Esposa/Esposo',0,0,'A para B',1,'2017-09-21 14:24:33','522b92f7-d2e2-4035-8683-4dfbc7bf95cb',0,NULL,NULL,NULL);
 INSERT IGNORE INTO `relationship_type` (`relationship_type_id`,`a_is_to_b`,`b_is_to_a`,`preferred`,`weight`,`description`,`creator`,`date_created`,`uuid`,`retired`,`retired_by`,`date_retired`,`retire_reason`) VALUES (10,'Avó/Avô','Neto/Neta',0,0,'A para B',1,'2017-09-21 14:28:12','4132a84c-f116-4369-b67d-9363b3399916',0,NULL,NULL,NULL);
 INSERT IGNORE INTO `relationship_type` (`relationship_type_id`,`a_is_to_b`,`b_is_to_a`,`preferred`,`weight`,`description`,`creator`,`date_created`,`uuid`,`retired`,`retired_by`,`date_retired`,`retire_reason`) VALUES (11,'Neto/Neta','Avó/Avô',0,0,'A para B',1,'2017-09-21 14:28:47','27219e8c-bb8a-42f7-a49b-81bb6171d877',0,NULL,NULL,NULL);
INSERT  IGNORE INTO `relationship_type` (`relationship_type_id`,`a_is_to_b`,`b_is_to_a`,`preferred`,`weight`,`description`,`creator`,`date_created`,`uuid`,`retired`,`retired_by`,`date_retired`,`retire_reason`) VALUES (12,'Pai','Filho/Filha',0,0,'Relacionamento entre mãe e filho',1,'2017-01-26 10:11:04','2b00dfef-a5dc-49e6-b406-76268393000a',0,NULL,NULL,NULL);
INSERT IGNORE INTO `relationship_type` (`relationship_type_id`,`a_is_to_b`,`b_is_to_a`,`preferred`,`weight`,`description`,`creator`,`date_created`,`uuid`,`retired`,`retired_by`,`date_retired`,`retire_reason`) VALUES  (13,'Filha/Filho','Pai',0,0,'A para B',1,'2017-09-15 09:34:39','0fe000fa-f2bc-463e-b01f-ea5899621dff',0,NULL,NULL,NULL);
		
		

		</sql>
	</diff>
 
	
</sqldiff>
